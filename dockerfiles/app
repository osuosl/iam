FROM osuosl/centos-ruby:2.3.0

RUN yum -y update
RUN yum -y install vim\
                   screen\
                   sudo\
                   sqlite-devel\
                   postgresql\
                   postgresql-devel

RUN gem install bundle
COPY Gemfile /tmp/Gemfile
WORKDIR /tmp/
RUN bundle install

RUN echo 'chown --reference=/data/code -R .' > /root/cleanup.sh
RUN chmod +x /root/cleanup.sh
RUN echo 'trap /root/cleanup.sh EXIT' >> /root/.bashrc

WORKDIR /
