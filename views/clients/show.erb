<div class="container">
<h2> Client: <%= @client.name %>
<a href="/clients/<%= @client.id %>/edit">edit</a>
</h2>
<p>
    Name: <%= @client.contact_name %> <br>
    Email: <%= @client.contact_email %> <br>
    Description: <%= @client.description %> <br>
    Active: <%= @client.active %>
</p>


<div id="client-<%= @client.id %>" class="panel-collapse collapse">
   <% Project.filter(client_id: @client.id).each do |p| %>
        <div class="panel-body">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <a data-toggle="collapse" href="#project-<%= p.id %>">
                            Project: <%= p.name %>
                        </a>
                    </h4>
                </div>
                <div id="project-<%= p.id %>" class"panel-collapse collapse">
                    <div class="panel-body">
                        <table class="table table-bordered table-hover">
                            <tr>
                                <td>
                                    Node:
                                </td>
                                <td>
                                    VCPUCount
                                </td>
                                <td>
                                    RamSize
                                </td>
                                <td>
                                    DiskSize
                                </td>
                                <td>
                                    DiskTemplate
                                </td>
                            </tr>
                            <% NodeResource.filter(project_id: p.id).each do |n| %>

                            <tr>
                                <td>
                                    <%= n.name %>
                                </td>
                                <td>
                                    <% data = VCPUCount.new.report({ node: n.name }) %>
                                    <%= DataUtil.average_value(data) %>
                                </td>
                                <td>
                                    <% data = RamSize.new.report({ node: n.name }) %>
                                    <% DataUtil.average_value(data) %>
                                </td>
                                <td>
                                    <% data = DiskSize.new.report({ node: n.name }) %>
                                    <% DataUtil.average_value(data) %>
                                </td>
                                <td>
                                    <% data = DiskTemplate.new.report({ node: n.name }) %>
                                    <% if data != nil && data.last != nil %>
                                        <%= data.last[:value] %>
                                    <% else %>
                                        Not Found
                                   <% end %>
                                </td>
                            </tr>
                         <% end %>

                      </table >
                     </div>
                    </div>
                 </div>
               </div>
            <% end %>
          </div>
        </div> 

    </div>
</div>
