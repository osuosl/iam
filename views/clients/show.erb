<div class="container">
<h2> Client: <%= @client.name %>
<a href="/clients/<%= @client.id %>/edit">edit</a>
</h2>
<p>
    Name: <%= @client.contact_name %> <br>
    Email: <%= @client.contact_email %> <br>
    Description: <%= @client.description %> <br>
    Active: <%= @client.active %>
</p>

  <h2> Projects <h2>
  <div class="panel-group">
     <% for @project in @projects %>
        <div class="panel panel-default">
            <div class="panel-heading">
                <h6 class="panel-title">
                    <a data-toggle="collapse" href="#project-<%= @project.id %>">
                       Project: <%= @project.name %>
                    </a>
                </h6>
            </div>
            <div id="project-<%= @project.id %>" class="panel-collapse collapse">     
              <% NodeResource.filter(project_id: @project.id).each do |p| %>
                 <div class="panel-body">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h6 class="panel-title"> 
                                <a data-toggle="collapse" href="#node-<%= p.id %>" >
                                    Node: <%= p.name %>
                                </a>
                            </h6>
                         </div>
                          <div id="node-<%= p.id %>" class="panel-collapse collapse">
                            <div class="panel-body">
                            <table class="table table-bordered table-hover">
                                <thead>
                                <tr>
                                    <th> Node Name    </th>
                                    <th> VCPUCount    </th>
                                    <th> RamSize      </th>
                                    <th> DiskSize     </th>
                                    <th> DiskTemplate </th>
                                </tr>
                                </thead>
                                <tbody>
                                <% NodeResource.filter(project_id: p.id).each do |n| %>
                                      <tr>
                                            <td> <%= n.name %> </td>
                                            <td> 
                                                 <% data = VCPUCount.new.report({node: n.name}) %>
                                                 <%= DataUtil.average_value(data) %>
                                            </td>
                                            <td>
                                                 <% data = RamSize.new.report({node: n.name}) %>
                                                 <%= DataUtil.average_value(data) %>
                                            </td>
                                            <td>
                                                <% data = DiskSize.new.report({node: n.name}) %>
                                                <%= DataUtil.average_value(data) %>
                                            </td>
                                            <td>
                                                <% data = DiskTemplate.new.report({node: n.name}) %>
                                                <% if data != nil && data.last != nil %>
                                                    <%= data.last[:value] %>
                                                <% else %>
                                                    Not Found
                                                <% end %>
                                            </td>
                                      </tr>
                                  <% end %>
                                </tbody>
                              </table>
                        </div>
                      </div>
                   </div> 
                </div>
              <% end %>
           </div>
        </div>
      <% end %>
  </div>
</div>
